<!doctype html>
<html lang="en" data-theme="dark">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.svg" />
		<link rel="manifest" href="%sveltekit.assets%/manifest.webmanifest" />
		<link rel="apple-touch-icon" href="%sveltekit.assets%/icon-192.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
		<meta name="theme-color" content="#0d1117" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous" />
		<title>AmityVox</title>
		<script>
			// Apply saved theme before first paint to prevent flash.
			(function() {
				var t = localStorage.getItem('av-theme') || 'dark';
				document.documentElement.setAttribute('data-theme', t);
				var fs = localStorage.getItem('av-font-size');
				if (fs) document.documentElement.style.fontSize = fs + 'px';
				if (localStorage.getItem('av-compact') === 'true') document.documentElement.setAttribute('data-compact', 'true');
				if (localStorage.getItem('av-reduced-motion') === 'true') document.documentElement.setAttribute('data-reduced-motion', 'true');
				if (localStorage.getItem('av-dyslexic-font') === 'true') document.documentElement.setAttribute('data-dyslexic-font', 'true');

				// Apply custom theme colors if one is active.
				var activeCustomTheme = localStorage.getItem('av-active-custom-theme');
				if (activeCustomTheme) {
					try {
						var themes = JSON.parse(localStorage.getItem('av-custom-themes') || '[]');
						var theme = themes.find(function(th) { return th.name === activeCustomTheme; });
						if (theme && theme.colors) {
							var root = document.documentElement;
							root.setAttribute('data-custom-theme', 'true');
							Object.keys(theme.colors).forEach(function(key) {
								root.style.setProperty('--' + key, theme.colors[key]);
							});
						}
					} catch(e) {}
				}
			})();
		</script>
		%sveltekit.head%
	</head>
	<body class="bg-bg-primary text-text-primary" data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
		<script>
			if ('serviceWorker' in navigator) {
				window.addEventListener('load', function() {
					navigator.serviceWorker.register('/sw.js').catch(function(err) {
						if (location.hostname === 'localhost') console.warn('SW registration failed:', err);
					});
				});
			}
		</script>
	</body>
</html>
